jQuery(document).ready((function(e){var r=member_login_data,t=r.isMemberContent,o=r.isSearchPage,n=r.siteHomeUrl,i=r.postTypeName,a=r.contentForMemberType,m=r.membersLogin,c=(r.membersSignUp,r.membersHub),l=r.membersHubFree,u=r.renewMembership,p=r.joinMembership,d=r.memberHubLink,s=r.memberLoginLink,b=r.memberHubFreeLink,f=r.renewMembershipLink,h=r.joinMembershipLink;function g(e){return e&&function(e){return!!(e.recordTypeId&&e.memberType&&e.membershipType)&&"NA"!==e.expiryDate&&"NA"!==e.gracePeriodDate&&!!["Paid","Free"].includes(e.memberType)&&"string"==typeof e.membershipType&&""!==e.membershipType.trim()}(e)?function(e,r){if("NA"===e||"NA"===r)return!0;var t=new Date,o=function(e){if(8!==e.length)return 0;var r=parseInt(e.substring(0,2)),t=parseInt(e.substring(2,4))-1,o=parseInt(e.substring(4,8));return new Date(o,t,r).getTime()}(r);return t.getTime()>o}(e.expiryDate,e.gracePeriodDate)?"expired":"Paid"===e.memberType?"full":"free":"none"}function _(e){return!e||Date.now()-e>864e5}function v(){localStorage&&(localStorage.removeItem("dv_membership_data"),localStorage.removeItem("dv_redirect_url"))}function y(){if(localStorage)try{var e=localStorage.getItem("dv_membership_data");if(e)return JSON.parse(e)}catch(e){console.error("Error parsing membership data from localStorage:",e)}return null}function w(e,r){return e&&e.url?e.url:r}function T(e,r){return e&&e.text?e.text:r}function I(e){var r=new RegExp("[?&]"+encodeURIComponent(e)+"=([^&]*)").exec(window.location.search);return null===r?"":decodeURIComponent(r[1].replace(/\+/g," "))}e((function(){var r=I("s"),T=I("error"),S=I("error_description"),D=I("RecordTypeId"),x=I("DA_Member_Type__c"),M=I("DA_Membership_Type__c"),L=I("Membership_Expiry_Date__pc"),P=I("DA_Expiry_after_grace_period__c"),A=e(".member-login-overlay");if(localStorage.getItem("dv_redirect_url"),D&&x&&M){var N={recordTypeId:D,memberType:x,membershipType:M,expiryDate:L,gracePeriodDate:P};!function(e){var r={recordTypeId:e.recordTypeId,memberType:e.memberType,membershipType:e.membershipType,expiryDate:e.expiryDate,gracePeriodDate:e.gracePeriodDate,timestamp:Date.now()};localStorage&&localStorage.setItem("dv_membership_data",JSON.stringify(r))}(N);var k=g(N),H=localStorage.getItem("dv_redirect_url");if(H&&function(e,r){if("none"===e||"expired"===e)return!1;try{var t=new URL(r,window.location.origin).pathname;return!(t.includes("/members-hub")||t.includes("/member-")||t.includes("/resource")||t.includes("/member-recipes"))||"free"===e||"full"===e}catch(e){return!1}}(k,H))return localStorage.removeItem("dv_redirect_url"),void(window.location.href=H);var R=function(e){switch(e){case"full":return w(c,d);case"free":return w(l,b);case"expired":return w(u,f);default:return w(p,h)}}(k);window.location.href=R}else{var U=y(),E=!!U;E&&U.timestamp&&_(U.timestamp)&&(v(),E=!1,U=null);var F=E?g(U):"none";if(1==t||"resource"==i||"member_recipes"==i){if(!o&&localStorage&&localStorage.setItem("dv_redirect_url",window.location.href),o||r)return void A.hide();if(!E)return void(window.location.href=w(m,s));if("none"===F||"expired"===F)return void(window.location.href="expired"===F?w(u,f):w(p,h));if(1==t&&"full_member_only"===a&&"free"===F)return void(window.location.href=w(l,b));A.hide()}else"/member-login/"===window.location.pathname||localStorage.removeItem("dv_redirect_url"),A.hide();if(T&&S)return A.show(),confirm("Error: Unable to login. Please try again.")?void(window.location.href=w(m,s)):void(window.location.href=n)}})),e(".btn-member-login").each((function(){var r=e(this),t=y(),o=!!t;o&&t.timestamp&&_(t.timestamp)&&(v(),o=!1,t=null);var n=o?g(t):"none";if(o){var i=T(c,"My Membership"),a=w(c,d);"none"===n?(i=T(p,"Join Membership"),a=w(p,h)):"expired"===n?(i=T(u,"Renew Membership"),a=w(u,f)):"free"===n?(i=T(l,"Free Member Hub"),a=w(l,b)):"full"===n&&(i=T(c,"My Membership"),a=w(c,d)),r.html("<span>"+i+"</span>"),r.attr("href",a)}else{var I=T(m,"Member Login"),S=w(m,s);r.html("<span>"+I+"</span>"),r.attr("href",S)}})),e(".btn-member-logout").each((function(){var r=e(this),t=y(),o=!!t;o&&t.timestamp&&_(t.timestamp)&&(v(),o=!1),o?r.show():r.hide()})),e(document).on("click",".btn-member-logout",(function(e){if(e.preventDefault(),confirm("Are you sure you want to log out?"))return localStorage&&(localStorage.removeItem("dv_redirect_url"),localStorage.removeItem("dv_membership_data")),void(window.location.href=n)}))}));