jQuery(document).ready((function(e){var r=member_login_data,o=r.isMemberContent,t=r.isSearchPage,i=r.memberHubLink,n=r.memberLoginLink,a=r.siteHomeUrl,m=r.postTypeName,c=r.contentForMemberType;function p(e){return e&&function(e){return!!(e.recordTypeId&&e.memberType&&e.membershipType)&&"NA"!==e.expiryDate&&"NA"!==e.gracePeriodDate&&!!["Paid","Free"].includes(e.memberType)&&"string"==typeof e.membershipType&&""!==e.membershipType.trim()}(e)?function(e,r){if("NA"===e||"NA"===r)return!0;var o=new Date,t=function(e){if(8!==e.length)return 0;var r=parseInt(e.substring(0,2)),o=parseInt(e.substring(2,4))-1,t=parseInt(e.substring(4,8));return new Date(t,o,r).getTime()}(r);return o.getTime()>t}(e.expiryDate,e.gracePeriodDate)?"expired":"Paid"===e.memberType?"full":"free":"none"}function l(){if(localStorage)try{var e=localStorage.getItem("dv_membership_data");if(e)return JSON.parse(e)}catch(e){console.error("Error parsing membership data from localStorage:",e)}return null}function s(e){var r=new RegExp("[?&]"+encodeURIComponent(e)+"=([^&]*)").exec(window.location.search);return null===r?"":decodeURIComponent(r[1].replace(/\+/g," "))}e((function(){var r=s("s"),d=s("error"),u=s("error_description"),b=s("RecordTypeId"),f=s("DA_Member_Type__c"),h=s("DA_Membership_Type__c"),g=s("Membership_Expiry_Date__pc"),y=s("DA_Expiry_after_grace_period__c"),_=e(".member-login-overlay");if(localStorage.getItem("dv_redirect_url"),b&&f&&h){var v={recordTypeId:b,memberType:f,membershipType:h,expiryDate:g,gracePeriodDate:y};!function(e){var r={recordTypeId:e.recordTypeId,memberType:e.memberType,membershipType:e.membershipType,expiryDate:e.expiryDate,gracePeriodDate:e.gracePeriodDate,timestamp:Date.now()};localStorage&&localStorage.setItem("dv_membership_data",JSON.stringify(r))}(v);var w=function(e){switch(e){case"full":return i;case"free":return a+"/members-hub-free-test/";case"expired":return a+"/renew-membership/";default:return a+"/join-membership/"}}(p(v));window.location.href=w}else{var T=l(),D=!!T,I=D?p(T):"none";if(1==o||"resource"==m||"member_recipes"==m){if(!t&&localStorage&&localStorage.setItem("dv_redirect_url",window.location.href),t||r)return void _.hide();if(!D)return void(window.location.href=n);if("none"===I||"expired"===I)return void(window.location.href="expired"===I?a+"/renew-membership/":a+"/join-membership/");if(1==o&&"full_member_only"===c&&"free"===I)return void(window.location.href=a+"/members-hub-free-test/");_.hide()}else"/member-login/"===window.location.pathname||localStorage.removeItem("dv_redirect_url"),_.hide();if(d&&u)return _.show(),confirm("Error: Unable to login. Please try again.")?void(window.location.href=n):void(window.location.href=a)}})),e(".btn-member-login").each((function(){var r=e(this),o=l(),t=!!o,m=t?p(o):"none";if(t){var c="My Membership",s=i;"none"===m?(c="Join Membership",s=a+"/join-membership/"):"expired"===m?(c="Renew Membership",s=a+"/renew-membership/"):"free"===m?(c="Free Member Hub",s=a+"/members-hub-free-test/"):"full"===m&&(c="My Membership",s=i),r.html("<span>"+c+"</span>"),r.attr("href",s)}else r.html("<span>Member Login</span>"),r.attr("href",n)})),e(".btn-member-logout").each((function(){var r=e(this);l()?r.show():r.hide()})),e(document).on("click",".btn-member-logout",(function(e){if(e.preventDefault(),confirm("Are you sure you want to log out?"))return localStorage&&(localStorage.removeItem("dv_redirect_url"),localStorage.removeItem("dv_membership_data")),void(window.location.href=a)}))}));