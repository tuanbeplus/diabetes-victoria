jQuery(document).ready((function(e){var r=member_login_data,t=r.isMemberContent,i=r.isSearchPage,n=r.siteHomeUrl,o=r.postTypeName,a=r.contentForMemberType,m=r.membersLogin,c=(r.membersSignUp,r.membersHub),l=r.membersHubFree,u=r.renewMembership,p=r.joinMembership,d=r.memberHubLink,s=r.memberLoginLink,b=r.memberHubFreeLink,f=r.renewMembershipLink,h=r.joinMembershipLink;function g(e){return e&&function(e){return!!(e.recordTypeId&&e.memberType&&e.membershipType)&&!!["Paid","Free"].includes(e.memberType)&&"string"==typeof e.membershipType&&""!==e.membershipType.trim()&&("Paid"!==e.memberType||"NA"!==e.expiryDate&&"NA"!==e.gracePeriodDate)}(e)?function(e,r,t){if("Free"===t&&("NA"===e||"NA"===r))return!1;if("Paid"===t&&("NA"===e||"NA"===r))return!0;var i=new Date,n=function(e){if(8!==e.length)return 0;var r=parseInt(e.substring(0,2)),t=parseInt(e.substring(2,4))-1,i=parseInt(e.substring(4,8));return new Date(i,t,r).getTime()}(r);return i.getTime()>n}(e.expiryDate,e.gracePeriodDate,e.memberType)?"expired":"Paid"===e.memberType?"full":"free":"none"}function _(e){return!e||Date.now()-e>864e5}function v(){localStorage&&(localStorage.removeItem("dv_membership_data"),localStorage.removeItem("dv_redirect_url"))}function y(){if(localStorage)try{var e=localStorage.getItem("dv_membership_data");if(e)return JSON.parse(e)}catch(e){console.error("Error parsing membership data from localStorage:",e)}return null}function w(e,r){return e&&e.url?e.url:r}function T(e,r){return e&&e.text?e.text:r}function I(e){var r=new RegExp("[?&]"+encodeURIComponent(e)+"=([^&]*)").exec(window.location.search);return null===r?"":decodeURIComponent(r[1].replace(/\+/g," "))}e((function(){var r=I("s"),T=I("error"),S=I("error_description"),D=I("RecordTypeId"),x=I("DA_Member_Type__c"),M=I("DA_Membership_Type__c"),P=I("Membership_Expiry_Date__pc"),A=I("DA_Expiry_after_grace_period__c"),L=e(".member-login-overlay");if(localStorage.getItem("dv_redirect_url"),D&&x&&M){var N={recordTypeId:D,memberType:x,membershipType:M,expiryDate:P,gracePeriodDate:A};!function(e){var r={recordTypeId:e.recordTypeId,memberType:e.memberType,membershipType:e.membershipType,expiryDate:e.expiryDate,gracePeriodDate:e.gracePeriodDate,timestamp:Date.now()};localStorage&&localStorage.setItem("dv_membership_data",JSON.stringify(r))}(N);var k=g(N),F=localStorage.getItem("dv_redirect_url");if(F&&function(e,r){if("none"===e||"expired"===e)return!1;try{var t=new URL(r,window.location.origin).pathname;return!(t.includes("/members-hub")||t.includes("/member-")||t.includes("/resource")||t.includes("/member-recipes"))||"free"===e||"full"===e}catch(e){return!1}}(k,F))return localStorage.removeItem("dv_redirect_url"),void(window.location.href=F);var H=function(e){switch(e){case"full":return w(c,d);case"free":return w(l,b);case"expired":return w(u,f);default:return w(p,h)}}(k);window.location.href=H}else{var R=y(),U=!!R;U&&R.timestamp&&_(R.timestamp)&&(v(),U=!1,R=null);var E=U?g(R):"none";if(1==t||"resource"==o||"member_recipes"==o){if(!i&&localStorage&&localStorage.setItem("dv_redirect_url",window.location.href),i||r)return void L.hide();if(!U)return void(window.location.href=w(m,s));if("none"===E||"expired"===E)return void(window.location.href="expired"===E?w(u,f):w(p,h));if(1==t&&"full_member_only"===a&&"free"===E)return void(window.location.href=w(l,b));L.hide()}else"/member-login/"===window.location.pathname||localStorage.removeItem("dv_redirect_url"),L.hide();if(T&&S)return L.show(),confirm("Error: Unable to login. Please try again.")?void(window.location.href=w(m,s)):void(window.location.href=n)}})),e(".btn-member-login").each((function(){var r=e(this),t=y(),i=!!t;i&&t.timestamp&&_(t.timestamp)&&(v(),i=!1,t=null);var n=i?g(t):"none";if(i){var o=T(c,"My Membership"),a=w(c,d);"none"===n?(o=T(p,"Join Membership"),a=w(p,h)):"expired"===n?(o=T(u,"Renew Membership"),a=w(u,f)):"free"===n?(o=T(l,"Free Member Hub"),a=w(l,b)):"full"===n&&(o=T(c,"My Membership"),a=w(c,d)),r.html("<span>"+o+"</span>"),r.attr("href",a)}else{var I=T(m,"Member Login"),S=w(m,s);r.html("<span>"+I+"</span>"),r.attr("href",S)}})),e(".btn-member-logout").each((function(){var r=e(this),t=y(),i=!!t;i&&t.timestamp&&_(t.timestamp)&&(v(),i=!1),i?r.show():r.hide()})),e(document).on("click",".btn-member-logout",(function(e){if(e.preventDefault(),confirm("Are you sure you want to log out?"))return localStorage&&(localStorage.removeItem("dv_redirect_url"),localStorage.removeItem("dv_membership_data")),void(window.location.href=n)}))}));